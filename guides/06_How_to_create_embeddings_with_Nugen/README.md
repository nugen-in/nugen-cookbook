## **Nugen Intelligence**
<img src="https://nugen.in/logo.png" alt="Nugen Logo" width="200"/>



# **Create Embeddings with Nugen API**

Text embeddings represent text strings as vectors of floating-point numbers. The distance (e.g., cosine similarity) between two embeddings indicates how related two pieces of text are, with smaller distances signifying greater similarity. This is useful in a range of applications like search, recommendation systems, and anomaly detection, especially in Retrieval-Augmented Generation (RAG) architectures.

## **Nugen API Integration**

Set up the Nugen API Key:


```python
import requests
import json

# Replace with your Nugen API key
api_key = <GET YOUR NUGEN API KEYS>

# URL for fetching embeddings for texts
embedding_url = "https://api.nugen.in/inference/embeddings"

headers = {
    "Authorization": f"Bearer {api_key}",
    "Content-Type": "application/json"
}

# Example texts
def get_nugen_embeddings(texts, model="nugen-flash-embed", dimensions=123):
    """Fetch embeddings for a list of texts from Nugen API."""
    data = {
        "input": texts,
        "model": model,
        "dimensions": dimensions
    }

    response = requests.post(embedding_url, headers=headers, data=json.dumps(data))

    if response.status_code == 200:
        response_json = response.json()
        return [entry["embedding"] for entry in response_json["data"]]
    else:
        print("Error:", response.status_code, response.text)
        return None
```

## Embed a list of documents


```python
# Example documents
documents = [
    "The Mediterranean diet emphasizes fish, olive oil, and vegetables, believed to reduce chronic diseases.",
    "Photosynthesis in plants converts light energy into glucose and produces essential oxygen.",
    "20th-century innovations, from radios to smartphones, centered on electronic advancements.",
    "Rivers provide water, irrigation, and habitat for aquatic species, vital for ecosystems.",
    "Appleâ€™s conference call to discuss fourth fiscal quarter results and business updates is scheduled for Thursday, November 2, 2023 at 2:00 p.m. PT / 5:00 p.m. ET.",
    "Shakespeare's works, like 'Hamlet' and 'A Midsummer Night's Dream,' endure in literature."
]

# Get document embeddings from Nugen API
doc_embds = get_nugen_embeddings(documents, model="nugen-flash-embed", dimensions=123)
if doc_embds:
    for i, embd in enumerate(doc_embds):
        print(f"Embedding for document {i + 1}: {embd}")
else:
    print("Failed to retrieve document embeddings")

# Example query
query = "When is Apple's conference call scheduled?"

# Get the embedding for the query
query_embd = get_nugen_embeddings([query], model="nugen-flash-embed", dimensions=123)
if query_embd:
    query_embd = query_embd[0]
    print("Embedding for query:", query_embd)
else:
    print("Failed to retrieve query embedding")
```

    Embedding for document 1: [0.15576171875, 0.11444091796875, -0.329833984375, -0.048736572265625, 0.10955810546875, -0.0743408203125, -0.0849609375, -0.0210418701171875, 0.13037109375, -0.050994873046875, 0.1083984375, 0.0172271728515625, 0.2490234375, -0.0007581710815429688, 0.0289764404296875, 0.038604736328125, -0.1820068359375, -0.0283203125, 0.042999267578125, 0.16162109375, -0.107666015625, -0.0022602081298828125, 0.01082611083984375, 0.020477294921875, 0.10162353515625, 0.189208984375, -0.00386810302734375, 0.168701171875, -0.03985595703125, -0.053497314453125, -0.00550079345703125, -0.239501953125, 0.049774169921875, 0.0521240234375, 0.0753173828125, -0.0865478515625, 0.11883544921875, 0.170654296875, 0.09075927734375, 0.009124755859375, -0.017822265625, 0.07745361328125, 0.09942626953125, -0.0926513671875, 0.12744140625, -0.08514404296875, 0.053924560546875, 0.0197601318359375, -0.0606689453125, -0.11737060546875, -0.01116943359375, -0.0268707275390625, -0.06787109375, -0.07818603515625, 0.051177978515625, -0.09344482421875, -0.03985595703125, -0.0084228515625, 0.05615234375, -0.141845703125, 0.115234375, 0.03656005859375, -0.11309814453125, 0.0718994140625, 0.0406494140625, -0.01611328125, -0.05816650390625, 0.1292724609375, -0.0258941650390625, 0.033294677734375, 0.152099609375, -0.1707763671875, 0.07415771484375, -0.01366424560546875, 0.061431884765625, -0.036865234375, -0.08917236328125, -0.01004791259765625, 0.06927490234375, 0.01849365234375, 0.043792724609375, 0.00888824462890625, 0.024078369140625, 0.003047943115234375, -0.0176239013671875, 0.0202178955078125, 0.038543701171875, -0.074951171875, 0.08526611328125, 0.04345703125, 0.051055908203125, -0.037933349609375, 0.0965576171875, 0.10296630859375, -0.042938232421875, 0.09588623046875, -0.037933349609375, 0.007167816162109375, -0.015472412109375, -0.0399169921875, -0.01511383056640625, -0.039947509765625, 0.07232666015625, -0.06793212890625, 0.07379150390625, 0.06292724609375, 0.15771484375, -0.041229248046875, -0.01317596435546875, 0.0758056640625, -0.07989501953125, 0.0037403106689453125, 0.0272674560546875, -0.069580078125, -0.04266357421875, -0.0653076171875, 0.163818359375, -0.10101318359375, 0.126220703125, 0.052001953125, -0.09588623046875, 0.0209808349609375, 0.07208251953125]
    Embedding for document 2: [0.10821533203125, 0.081298828125, -0.351318359375, 0.07684326171875, 0.057098388671875, 0.043609619140625, -0.08624267578125, 0.09014892578125, -0.04010009765625, -0.04595947265625, 0.1109619140625, 0.068115234375, 0.189208984375, 0.005451202392578125, -0.0145263671875, 0.04736328125, -0.012481689453125, -0.104248046875, 0.072509765625, 0.07269287109375, -0.0821533203125, -0.058624267578125, 0.0246124267578125, -0.021728515625, 0.06756591796875, 0.11871337890625, -0.00341796875, -0.0765380859375, 0.0053863525390625, 0.051727294921875, 0.12420654296875, -0.084716796875, 0.07415771484375, 0.0170745849609375, -0.058990478515625, -0.12371826171875, 0.06756591796875, 0.06610107421875, 0.145751953125, 0.08306884765625, -0.051483154296875, 0.046966552734375, 0.06146240234375, -0.0294342041015625, 0.062225341796875, -0.08782958984375, 0.06365966796875, -0.068603515625, -0.01076507568359375, -0.0249481201171875, 0.12042236328125, 0.0250244140625, -0.13427734375, -0.0224609375, 0.2071533203125, 0.10479736328125, 0.0396728515625, 0.009185791015625, 0.107666015625, 0.1304931640625, 0.036224365234375, 0.143310546875, -0.04412841796875, 0.099609375, 0.0904541015625, -0.1361083984375, 0.005054473876953125, 0.02783203125, -0.057098388671875, 0.0247344970703125, 0.07012939453125, -0.07342529296875, 0.0521240234375, -0.0172882080078125, 0.10992431640625, -0.04669189453125, -0.03466796875, 0.0290069580078125, -0.03900146484375, 0.05987548828125, 0.05426025390625, 0.01490020751953125, 0.1099853515625, -0.01348114013671875, 0.162841796875, -0.078857421875, -0.05120849609375, -0.031982421875, -0.016754150390625, 0.1109619140625, 0.136962890625, 0.0655517578125, 0.315185546875, -0.05975341796875, -0.2264404296875, 0.0158843994140625, 0.061370849609375, 0.09796142578125, -0.10882568359375, -0.07135009765625, -0.0182647705078125, -0.09954833984375, 0.01157379150390625, -0.09423828125, 0.1884765625, -0.023681640625, 0.0200347900390625, -0.03765869140625, 0.01000213623046875, -0.0401611328125, -0.07318115234375, 0.077880859375, 0.01091766357421875, -0.050262451171875, 0.0199737548828125, -0.06866455078125, 0.1396484375, -0.0220947265625, 0.04827880859375, 0.0618896484375, -0.0281829833984375, 0.050384521484375, -0.0067596435546875]
    Embedding for document 3: [0.01435089111328125, 0.1492919921875, -0.405517578125, 0.01500701904296875, 0.11883544921875, 0.031524658203125, -0.005786895751953125, -0.0262451171875, 0.054046630859375, -0.046661376953125, 0.024322509765625, 0.020538330078125, 0.1678466796875, 0.128173828125, 0.0303802490234375, -0.11993408203125, -0.08001708984375, -0.057373046875, -0.06719970703125, 0.1463623046875, 0.1248779296875, -0.059539794921875, -0.1591796875, -0.0269012451171875, -0.00522613525390625, 0.08477783203125, 0.06231689453125, -0.058258056640625, -0.04571533203125, -0.10064697265625, 0.116943359375, -0.1588134765625, 0.00110626220703125, 0.11517333984375, -0.0933837890625, -0.103759765625, -0.004535675048828125, 0.003326416015625, 0.125244140625, 0.0743408203125, 0.09698486328125, 0.025726318359375, -0.0697021484375, -0.02557373046875, 0.202880859375, -0.0880126953125, 0.03515625, -0.0706787109375, 0.1612548828125, 0.020294189453125, 0.029754638671875, 0.043121337890625, 0.027496337890625, -0.051025390625, 0.1168212890625, -0.08294677734375, -0.050811767578125, 0.062469482421875, 0.07098388671875, -0.039337158203125, 0.1417236328125, 0.1842041015625, -0.035247802734375, 0.1153564453125, 0.1279296875, -0.057373046875, 0.007656097412109375, 0.05560302734375, -0.0947265625, -0.05462646484375, 0.09844970703125, -0.132080078125, 0.06524658203125, 0.034698486328125, 0.0285797119140625, 0.0750732421875, -0.08563232421875, -0.077392578125, -0.06927490234375, 0.017852783203125, 0.06927490234375, -0.052642822265625, 0.1876220703125, -0.06842041015625, 0.034881591796875, -0.05950927734375, 0.050872802734375, 0.05560302734375, -0.023193359375, 0.1474609375, 0.125732421875, 0.01479339599609375, 0.0183258056640625, 0.0176544189453125, -0.0933837890625, -0.1329345703125, 0.0173492431640625, 0.036590576171875, 0.03619384765625, 0.02801513671875, -0.01561737060546875, -0.041656494140625, 0.048370361328125, -0.03729248046875, 0.10101318359375, 0.1312255859375, 0.0201263427734375, -0.09234619140625, -0.06512451171875, 0.0450439453125, -0.0199737548828125, 0.059600830078125, -0.038360595703125, -0.10272216796875, -0.01995849609375, 0.0220947265625, 0.1107177734375, -0.06573486328125, 0.045196533203125, 0.0210723876953125, 0.0064849853515625, -0.1474609375, 0.0023193359375]
    Embedding for document 4: [0.055419921875, 0.09576416015625, -0.353271484375, -0.108154296875, 0.1378173828125, 0.08953857421875, -0.042327880859375, 0.06292724609375, 0.05609130859375, -0.0236053466796875, 0.08880615234375, 0.0894775390625, 0.1806640625, 0.02227783203125, -0.114013671875, 0.0286712646484375, -0.10565185546875, -0.055389404296875, 0.0244140625, 0.09405517578125, -0.142578125, 0.00801849365234375, 0.121337890625, 0.12646484375, 0.1165771484375, 0.1488037109375, 0.006744384765625, -0.033203125, -0.1014404296875, -0.021514892578125, 0.003757476806640625, 0.02490234375, -0.007778167724609375, 0.00962066650390625, -0.056243896484375, -0.07550048828125, 0.0338134765625, 0.0016126632690429688, 0.1707763671875, -0.0853271484375, 0.061859130859375, -0.020233154296875, -0.0772705078125, -0.033935546875, 0.07855224609375, -0.11126708984375, 0.133544921875, -0.14794921875, 0.110107421875, -0.1724853515625, 0.081298828125, -0.04522705078125, -0.220947265625, 0.09161376953125, 0.01226806640625, 0.09661865234375, -0.0297088623046875, 0.004276275634765625, 0.0792236328125, -0.01343536376953125, 0.080810546875, 0.13818359375, -0.0841064453125, 0.095703125, 0.02166748046875, -0.0447998046875, -0.0293121337890625, 0.07012939453125, -0.0693359375, 0.056976318359375, 0.10491943359375, -0.08416748046875, 0.03314208984375, -0.02880859375, 0.01457977294921875, -0.001239776611328125, -0.07861328125, 0.07562255859375, -0.03717041015625, -0.03485107421875, 0.1973876953125, 0.0784912109375, 0.06622314453125, 0.04949951171875, 0.156005859375, 0.084716796875, -0.0285797119140625, -0.08001708984375, 0.0199432373046875, 0.07415771484375, 0.01357269287109375, 0.11083984375, 0.04962158203125, 0.05438232421875, -0.1329345703125, -0.031707763671875, -0.03448486328125, -0.032958984375, -0.0318603515625, -0.016204833984375, -0.05816650390625, -0.03009033203125, 0.0943603515625, 0.00431060791015625, 0.2293701171875, 0.05755615234375, 0.10009765625, -0.03131103515625, -0.056976318359375, -0.08184814453125, -0.03790283203125, -0.035888671875, -0.047088623046875, -0.0016355514526367188, -0.049957275390625, 0.01195526123046875, 0.1337890625, -0.01381683349609375, 0.01525115966796875, 0.2025146484375, 0.003360748291015625, -0.034027099609375, 0.012969970703125]
    Embedding for document 5: [0.0170745849609375, 0.10302734375, -0.368408203125, 0.022674560546875, 0.048553466796875, 0.00848388671875, 0.007183074951171875, -0.168212890625, 0.04388427734375, -0.007160186767578125, 0.005645751953125, 0.08966064453125, 0.033172607421875, 0.05987548828125, 0.0732421875, 0.006504058837890625, -0.09161376953125, -0.042572021484375, -0.07232666015625, 0.138916015625, 0.00890350341796875, -0.02777099609375, -0.1728515625, 0.0966796875, 0.085205078125, 0.0870361328125, 0.020477294921875, 0.1458740234375, 0.04583740234375, -0.0308837890625, 0.07666015625, 0.0273590087890625, -0.005275726318359375, -0.0709228515625, -0.159423828125, -0.13720703125, 0.09686279296875, -0.0196075439453125, -0.082275390625, -0.09771728515625, 0.0103302001953125, -0.051727294921875, 0.06298828125, -0.0654296875, 0.10797119140625, -0.0892333984375, 0.0673828125, 0.0125885009765625, 0.06719970703125, -0.1890869140625, 0.036346435546875, 0.10247802734375, -0.03753662109375, 0.0217437744140625, -0.040435791015625, 0.156005859375, 0.0017328262329101562, 0.1220703125, -0.08831787109375, 0.015960693359375, 0.308837890625, 0.08660888671875, 0.1204833984375, 0.10186767578125, 0.1510009765625, 0.049102783203125, 0.00016927719116210938, 0.024566650390625, -0.046356201171875, -0.10772705078125, 0.08184814453125, -0.0849609375, 0.0182952880859375, 0.019073486328125, -0.023284912109375, -0.0027027130126953125, -0.0166168212890625, -0.044769287109375, -0.1063232421875, 0.016021728515625, -0.05377197265625, -0.033660888671875, 0.065673828125, 0.05218505859375, 0.09814453125, 0.0099334716796875, 0.06182861328125, 0.060882568359375, 0.03460693359375, 0.1900634765625, -0.0266265869140625, 0.027740478515625, -0.051544189453125, 0.0146942138671875, -0.125732421875, 0.06890869140625, 0.0019388198852539062, -0.0035610198974609375, -0.0870361328125, -0.06298828125, -0.1314697265625, -0.05499267578125, -0.0206451416015625, -0.04046630859375, -0.001399993896484375, 0.1353759765625, 0.004985809326171875, -0.004730224609375, -0.048980712890625, 0.05218505859375, -0.1490478515625, 0.143310546875, 0.047943115234375, -0.0005698204040527344, 0.024505615234375, 0.0008325576782226562, 0.07659912109375, -0.114990234375, 0.06292724609375, 0.052978515625, 0.05224609375, -0.2208251953125, 0.024261474609375]
    Embedding for document 6: [0.0202484130859375, 0.0601806640625, -0.34716796875, -0.1253662109375, -0.0162811279296875, 0.005565643310546875, -0.067626953125, 0.12481689453125, 0.03179931640625, 0.09552001953125, -0.0362548828125, -0.057373046875, 0.09490966796875, -0.00862884521484375, -0.0562744140625, -0.08880615234375, -0.04986572265625, -0.04864501953125, -0.0203094482421875, 0.1951904296875, -0.11639404296875, -0.004611968994140625, 0.08935546875, 0.038330078125, 0.07269287109375, 0.11773681640625, -0.1505126953125, -0.0657958984375, -0.1112060546875, 0.07440185546875, 0.037872314453125, 0.05938720703125, 0.035614013671875, -0.06744384765625, 0.0025997161865234375, -0.058349609375, -0.07818603515625, 0.04901123046875, 0.0223388671875, 0.036834716796875, 0.07745361328125, -0.0440673828125, 0.0474853515625, 0.0188446044921875, 0.2056884765625, -0.1746826171875, -0.0213775634765625, -0.0537109375, -0.043975830078125, -0.0007104873657226562, 0.17578125, -0.1695556640625, 0.0855712890625, -0.048828125, 0.1356201171875, 0.1490478515625, 0.05841064453125, -0.12255859375, -0.03375244140625, -0.1307373046875, 0.0060272216796875, 0.051727294921875, -0.0791015625, 0.109619140625, -0.040924072265625, -0.0291748046875, -0.2186279296875, 0.11077880859375, -0.038818359375, -0.06549072265625, 0.150634765625, -0.04339599609375, 0.060791015625, 0.0106964111328125, -0.0305328369140625, 0.042083740234375, -0.00856781005859375, -0.12078857421875, 0.0211181640625, 0.0809326171875, 0.0753173828125, -0.046875, 0.06683349609375, 0.077880859375, 0.173095703125, 0.1370849609375, 0.07415771484375, -0.0687255859375, -0.049163818359375, 0.16064453125, 0.1737060546875, 0.0601806640625, 0.0494384765625, 0.05499267578125, -0.07177734375, 0.01326751708984375, -0.00110626220703125, -0.01568603515625, -0.0498046875, -0.043701171875, -0.090576171875, -0.022491455078125, 0.0268096923828125, -0.0740966796875, 0.1292724609375, 0.08905029296875, 0.0516357421875, 0.09197998046875, -0.05615234375, 0.05291748046875, -0.1124267578125, 0.03900146484375, -0.1300048828125, -0.07891845703125, 0.003986358642578125, 0.040771484375, 0.015289306640625, -0.0712890625, 0.047027587890625, 0.005924224853515625, -0.048431396484375, 0.07757568359375, 0.0743408203125]
    Embedding for query: [-0.0148162841796875, 0.127197265625, -0.338623046875, -0.0144805908203125, 0.1109619140625, 0.03546142578125, 0.052093505859375, -0.09588623046875, -0.034637451171875, 0.04046630859375, -0.040374755859375, 0.097412109375, 0.08941650390625, 0.0732421875, 0.109619140625, -0.08331298828125, -0.08990478515625, -0.038421630859375, -0.1319580078125, 0.10675048828125, 0.03985595703125, -0.037841796875, -0.171142578125, 0.0982666015625, 0.0765380859375, 0.07476806640625, 0.06549072265625, 0.16162109375, -0.0227508544921875, -0.049560546875, 0.1500244140625, 0.0389404296875, 0.0260467529296875, -0.0794677734375, -0.09124755859375, -0.0748291015625, -0.029266357421875, -0.0633544921875, -0.10369873046875, 0.0131988525390625, 0.024993896484375, 0.004383087158203125, 0.0740966796875, -0.167724609375, 0.104736328125, -0.0501708984375, 0.0782470703125, 0.050994873046875, 0.08282470703125, -0.154052734375, 0.037139892578125, 0.050048828125, -0.07562255859375, 0.005664825439453125, -0.0090179443359375, 0.109130859375, 0.060150146484375, 0.1300048828125, -0.045013427734375, 0.0784912109375, 0.33544921875, 0.090576171875, 0.041961669921875, 0.056396484375, 0.133056640625, 0.0229034423828125, 0.0031223297119140625, 0.04150390625, -0.08349609375, -0.06671142578125, 0.001129150390625, -0.18798828125, 0.0310821533203125, 0.029327392578125, 0.017303466796875, 0.003711700439453125, 0.05108642578125, -0.0809326171875, -0.07073974609375, 0.01261138916015625, -0.0853271484375, -0.036590576171875, 0.140869140625, -0.032684326171875, 0.0567626953125, 0.0889892578125, -0.0214691162109375, 0.0706787109375, 0.03546142578125, 0.230712890625, 0.0305633544921875, 0.01140594482421875, -0.080078125, -0.03216552734375, -0.02734375, 0.10577392578125, 0.002857208251953125, -0.0276031494140625, -0.095458984375, -0.045196533203125, -0.038421630859375, -0.037689208984375, -0.048248291015625, -0.065185546875, 0.005283355712890625, 0.1295166015625, -0.04443359375, -0.0521240234375, -0.038421630859375, -0.024932861328125, -0.051513671875, 0.09210205078125, 0.0034503936767578125, 0.02447509765625, 0.046051025390625, -0.05450439453125, 0.1038818359375, -0.11480712890625, 0.114501953125, 0.004547119140625, -0.0301971435546875, -0.2086181640625, -0.0189208984375]


The embeddings returned will be numerical vectors representing the documents, which we can use for semantic similarity comparisons.

## Get embeddings from the Nugen API


        {
        "object": "list",
          "data": [
            {
              "embedding": [0.02012746, 0.01957859, ...],
              "index": 0
            },
            {
              "embedding": [0.01429677, 0.03077182, ...],
              "index": 1
            }
          ],
          "model": "nugen-flash-embed",
          "usage": {
            "total_tokens": 10
          }
        }

## Nearest Neighbor Search Using Nugen Embeddings

Now let's use the Nugen embeddings to conduct a nearest neighbor search for semantic retrieval. Given an example query, we convert it into an embedding and find the most relevant document based on the cosine similarity in the embedding space.

Embed the query and compute similarities:


```python
query = "When is Apple's conference call scheduled?"

# Get the embedding for the query
query_embd = get_nugen_embeddings([query], model="nugen-flash-embed", dimensions=123)
if query_embd:
    query_embd = query_embd[0]
else:
    print("Failed to retrieve query embedding")

# Compute the similarity
# Nugen embeddings are normalized to length 1, therefore dot-product is the same as cosine similarity
if doc_embds and query_embd:
    doc_embds_np = np.array(doc_embds)
    query_embd_np = np.array(query_embd)
    similarities = np.dot(doc_embds_np, query_embd_np)
    retrieved_id = np.argmax(similarities)
    print(f"The most relevant document is: {documents[retrieved_id]}")
else:
    print("Failed to compute similarities")

```

    The most relevant document is: Appleâ€™s conference call to discuss fourth fiscal quarter results and business updates is scheduled for Thursday, November 2, 2023 at 2:00 p.m. PT / 5:00 p.m. ET.


**In this code:**

1. We send the query to Nugen's API to get its embedding.
2. We calculate the cosine similarity between the query embedding and the
3. document embeddings using np.dot.
4. The document with the highest similarity score is identified and printed.

This approach allows us to use Nugen's powerful embeddings to perform semantic search across a set of documents.
